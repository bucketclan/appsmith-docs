"use strict";(self.webpackChunkappsmith_docs=self.webpackChunkappsmith_docs||[]).push([[2837],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>m});var n=a(67294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=p(a),m=o,c=u["".concat(l,".").concat(m)]||u[m]||h[m]||r;return a?n.createElement(c,i(i({ref:t},d),{},{components:a})):n.createElement(c,i({ref:t},d))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var p=2;p<r;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},79640:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var n=a(87462),o=(a(67294),a(3905));const r={sidebar_position:7},i="Google Sheets",s={unversionedId:"reference/datasources/querying-google-sheets",id:"reference/datasources/querying-google-sheets",title:"Google Sheets",description:"Google Sheets is a web-based application provided by Google that enables users to create, update and share spreadsheets online in real-time.",source:"@site/docs/reference/datasources/querying-google-sheets.md",sourceDirName:"reference/datasources",slug:"/reference/datasources/querying-google-sheets",permalink:"/appsmith-docs/reference/datasources/querying-google-sheets",draft:!1,editUrl:"https://github.com/bucketclan/appsmith-docs/blob/v1.5/website/docs/reference/datasources/querying-google-sheets.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Firestore",permalink:"/appsmith-docs/reference/datasources/querying-firestore"},next:{title:"GraphQL",permalink:"/appsmith-docs/reference/datasources/graphql"}},l={},p=[{value:"<strong>Create Google Sheets Datasource</strong>",id:"create-google-sheets-datasource",level:2},{value:"Connection Settings",id:"connection-settings",level:2},{value:"<strong>Scope</strong>",id:"scope",level:3},{value:"Read Files",id:"read-files",level:3},{value:"Read, Edit, and Create Files",id:"read-edit-and-create-files",level:3},{value:"Read, Edit, Create, and Delete Files",id:"read-edit-create-and-delete-files",level:3},{value:"<strong>Save and Authorize</strong>",id:"save-and-authorize",level:3},{value:"<strong>Create Queries</strong>",id:"create-queries",level:2},{value:"<strong>Query</strong>",id:"query",level:3},{value:"<strong>Operation</strong>",id:"operation",level:2},{value:"<strong>Fetch Details</strong>",id:"fetch-details",level:2},{value:"<strong>Insert One</strong>",id:"insert-one",level:2},{value:"<strong>Insert a new Spreadsheet</strong>",id:"insert-a-new-spreadsheet",level:3},{value:"Insert new row to Sheet",id:"insert-new-row-to-sheet",level:3},{value:"Update One",id:"update-one",level:2},{value:"Delete One",id:"delete-one",level:2},{value:"Delete a Spreadsheet",id:"delete-a-spreadsheet",level:3},{value:"Delete a Sheet",id:"delete-a-sheet",level:3},{value:"Delete a Sheet Row",id:"delete-a-sheet-row",level:3},{value:"Fetch Many",id:"fetch-many",level:2},{value:"Fetch Many Spreadsheet",id:"fetch-many-spreadsheet",level:3},{value:"Fetch Many Sheet Rows",id:"fetch-many-sheet-rows",level:3},{value:"Insert Many",id:"insert-many",level:2},{value:"<strong>Update Many</strong>",id:"update-many",level:2},{value:"<strong>Common Settings</strong>",id:"common-settings",level:2},{value:"<strong>Entity</strong>",id:"entity",level:3},{value:"<strong>Spreadsheet</strong>",id:"spreadsheet",level:4},{value:"<strong>Sheet Name</strong>",id:"sheet-name",level:4},{value:"<strong>Table Heading Row Index</strong>",id:"table-heading-row-index",level:4},{value:"<strong>Columns</strong>",id:"columns",level:4},{value:"<strong>Filter Format</strong>",id:"filter-format",level:3},{value:"<strong>Cell Range</strong>",id:"cell-range",level:4},{value:"<strong>Where Clause</strong>",id:"where-clause",level:4},{value:"<strong>Using Queries in applications</strong>",id:"using-queries-in-applications",level:3}],d={toc:p};function h(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"google-sheets"},"Google Sheets"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.google.com/sheets/about/"},"Google Sheets")," is a web-based application provided by ",(0,o.kt)("a",{parentName:"p",href:"https://www.google.com/"},"Google")," that enables users to create, update and share spreadsheets online in real-time."),(0,o.kt)("p",null,"Spreadsheets are a common way of organizing, editing, and analyzing data and serve as a data source for many teams."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"To integrate Google Sheets with Appsmith, you should understand the ",(0,o.kt)("a",{parentName:"p",href:"/core-concepts/connecting-to-data-sources/"},"basics of connecting to databases on Appsmith"),".")),(0,o.kt)("p",null,"Appsmith integration with Google Sheets provides an easy way to manipulate, analyze and manage Spreadsheets. With this integration, you can perform different operations using a custom UI built on Appsmith, with minimal configurations."),(0,o.kt)("h2",{id:"create-google-sheets-datasource"},(0,o.kt)("strong",{parentName:"h2"},"Create Google Sheets Datasource")),(0,o.kt)("p",null,"To add a ",(0,o.kt)("strong",{parentName:"p"},"Google Sheets datasource"),", navigate to ",(0,o.kt)("strong",{parentName:"p"},"Explorer")," >> Click plus sign ",(0,o.kt)("strong",{parentName:"p"},"(+)")," next to ",(0,o.kt)("strong",{parentName:"p"},"Datasources")," >> Select ",(0,o.kt)("strong",{parentName:"p"},"Google Sheets")," under APIs."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/P222_GQTSDI?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Creating a Google Sheets Datasource in Appsmith"))),(0,o.kt)("h2",{id:"connection-settings"},"Connection Settings"),(0,o.kt)("p",null,"Configure the Google Sheets Datasource as illustrated below:"),(0,o.kt)("h3",{id:"scope"},(0,o.kt)("strong",{parentName:"h3"},"Scope")),(0,o.kt)("p",null,"Your datasource\u2019s ",(0,o.kt)("strong",{parentName:"p"},"scope")," setting defines what type of access privileges your app will have when working with your Google Sheets. Use this option to allow only the necessary operations that your app requires. This will help avoid accidentally deleting or overwriting data."),(0,o.kt)("p",null,(0,o.kt)("img",{src:a(53955).Z,width:"1600",height:"608"})),(0,o.kt)("h3",{id:"read-files"},"Read Files"),(0,o.kt)("p",null,"You can use the ",(0,o.kt)("strong",{parentName:"p"},"Read Files")," scope if you\u2019d like to provide limited access to Sheets, which is restricted to only listing existing spreadsheets or reading data from them."),(0,o.kt)("p",null,"The Read permission is required for the following query types:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#fetch-details"},"Fetch Details")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#fetch-many"},"Fetch Many"))),(0,o.kt)("h3",{id:"read-edit-and-create-files"},"Read, Edit, and Create Files"),(0,o.kt)("p",null,"If you want to perform additional operations like creating new spreadsheets or updating existing ones, you can use the ",(0,o.kt)("strong",{parentName:"p"},"Read, Edit, and Create Files")," scope to configure your datasource."),(0,o.kt)("p",null,"The ",(0,o.kt)("strong",{parentName:"p"},"Edit")," and ",(0,o.kt)("strong",{parentName:"p"},"Create")," permissions are required for the following query types:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#insert-one"},"Insert One")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#insert-many"},"Insert Many")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#update-one"},"Update One ")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#update-many"},"Update Many"))),(0,o.kt)("h3",{id:"read-edit-create-and-delete-files"},"Read, Edit, Create, and Delete Files"),(0,o.kt)("p",null,"In order to delete spreadsheets, you will be required to authorize the Read, Edit, Create, and Delete scope for your datasource."),(0,o.kt)("p",null,"The ",(0,o.kt)("strong",{parentName:"p"},"Delete")," permission is required for the following query type:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#delete-one"},"Delete One"))),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"When configured with this scope, queries related to this datasource may be potentially destructive and should be used carefully to avoid accidentally deleting data!"),(0,o.kt)("p",{parentName:"admonition"},"Consider enabling the ",(0,o.kt)("a",{parentName:"p",href:"/appsmith-docs/core-concepts/data-access-and-binding/querying-a-database/query-settings#request-confirmation-before-running-query"},(0,o.kt)("strong",{parentName:"a"},"Request confirmation before running query"))," setting to help prevent unintentional loss of data.")),(0,o.kt)("h3",{id:"save-and-authorize"},(0,o.kt)("strong",{parentName:"h3"},"Save and Authorize")),(0,o.kt)("p",null,"Click on the ",(0,o.kt)("strong",{parentName:"p"},"Save and Authorize")," button once you have selected your desired scope. You'll automatically be navigated to a Google Login screen, where you should select and log-in to the account whose spreadsheets you\u2019d like to access."),(0,o.kt)("p",null,"On successful login, you will be shown a screen where you will be asked to grant Appsmith certain permissions relating to managing your Google Sheets. Be sure to click Allow in order for Google Sheets to allow Appsmith to manage your spreadsheets."),(0,o.kt)("h2",{id:"create-queries"},(0,o.kt)("strong",{parentName:"h2"},"Create Queries")),(0,o.kt)("p",null,"You can add queries to Google Sheets datasource by selecting the ",(0,o.kt)("strong",{parentName:"p"},"New API +")," button available on the datasource page or by navigating to ",(0,o.kt)("strong",{parentName:"p"},"Explorer")," >> Click plus sign ",(0,o.kt)("strong",{parentName:"p"},"(+)")," next to ",(0,o.kt)("strong",{parentName:"p"},"Queries/JS")," >> Select the ",(0,o.kt)("strong",{parentName:"p"},"datasource")," name (GoogleSheetsDatasource)."),(0,o.kt)("h3",{id:"query"},(0,o.kt)("strong",{parentName:"h3"},"Query")),(0,o.kt)("p",null,"You use the ",(0,o.kt)("a",{parentName:"p",href:"broken-reference"},"Query")," tab to define - the type of operation you want to perform and the entity on which the operation will be performed."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Some ",(0,o.kt)("strong",{parentName:"p"},"operations")," are ",(0,o.kt)("strong",{parentName:"p"},"not")," available for some ",(0,o.kt)("strong",{parentName:"p"},"entities"),". If an ",(0,o.kt)("strong",{parentName:"p"},"operation")," is ",(0,o.kt)("strong",{parentName:"p"},"not")," available for an ",(0,o.kt)("strong",{parentName:"p"},"entity,")," the ",(0,o.kt)("strong",{parentName:"p"},"entity")," is grayed out, and the tooltip ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"Action not supported"))," will be displayed when you hover over it.")),(0,o.kt)("h2",{id:"operation"},(0,o.kt)("strong",{parentName:"h2"},"Operation")),(0,o.kt)("p",null,"Operation lets you define the type of action you want to perform on Google Sheets (Spreadsheets or individual Sheets available in a spreadsheet). Following is the list of available operations:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Operation")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Description")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"th"},"Available on below Entity")))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/appsmith-docs/reference/datasources/querying-google-sheets#fetch-details"},(0,o.kt)("strong",{parentName:"a"},"Fetch Details"))),(0,o.kt)("td",{parentName:"tr",align:null},"Use it to fetch details like the name of the spreadsheet, created date and time, and more"),(0,o.kt)("td",{parentName:"tr",align:null},"Spreadsheet")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/appsmith-docs/reference/datasources/querying-google-sheets#insert-one"},(0,o.kt)("strong",{parentName:"a"},"Insert One"))),(0,o.kt)("td",{parentName:"tr",align:null},"Use it to insert a single row in a sheet or add a new spreadsheet"),(0,o.kt)("td",{parentName:"tr",align:null},"Spreadsheet/Sheet Rows")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/appsmith-docs/reference/datasources/querying-google-sheets#update-one"},(0,o.kt)("strong",{parentName:"a"},"Update One"))),(0,o.kt)("td",{parentName:"tr",align:null},"Use it to update rows in a given sheet in a spreadsheet"),(0,o.kt)("td",{parentName:"tr",align:null},"Sheet Rows")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/appsmith-docs/reference/datasources/querying-google-sheets#delete-one"},(0,o.kt)("strong",{parentName:"a"},"Delete One"))),(0,o.kt)("td",{parentName:"tr",align:null},"Use it to delete a spreadsheet or a sheet or row in a sheet"),(0,o.kt)("td",{parentName:"tr",align:null},"Spreadsheet/Sheet/ Sheet Rows")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/appsmith-docs/reference/datasources/querying-google-sheets#fetch-many-sheet-rows"},(0,o.kt)("strong",{parentName:"a"},"Fetch Many"))),(0,o.kt)("td",{parentName:"tr",align:null},"Use it to fetch data from a sheet or all the spreadsheets available in your account."),(0,o.kt)("td",{parentName:"tr",align:null},"Spreadsheet/Sheet Rows")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/appsmith-docs/reference/datasources/querying-google-sheets#insert-many"},(0,o.kt)("strong",{parentName:"a"},"Insert Many"))),(0,o.kt)("td",{parentName:"tr",align:null},"Use it to insert multiple rows in a given sheet"),(0,o.kt)("td",{parentName:"tr",align:null},"Sheet Rows")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/appsmith-docs/reference/datasources/querying-google-sheets#update-many"},(0,o.kt)("strong",{parentName:"a"},"Update Many"))),(0,o.kt)("td",{parentName:"tr",align:null},"Use it to update multiple rows in a given sheet"),(0,o.kt)("td",{parentName:"tr",align:null},"Sheet Rows")))),(0,o.kt)("h2",{id:"fetch-details"},(0,o.kt)("strong",{parentName:"h2"},"Fetch Details")),(0,o.kt)("p",null,"The operation allows you to fetch the details of a given spreadsheet."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/elAabPXK_xk?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Fetch Details of a Spreadsheet"))),(0,o.kt)("p",null,"You can set the parameter values as below:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#operation"},"Operation")," - Fetch details"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Spreadsheet"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#spreadsheet"},"Spreadsheet")," - Either select the name of the spreadsheet from the available options, or you can enable the JS label and add the URL of the desired spreadsheet")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The ",(0,o.kt)("strong",{parentName:"p"},"Fetch Details")," operation is only available to fetch the details of a spreadsheet.")),(0,o.kt)("h2",{id:"insert-one"},(0,o.kt)("strong",{parentName:"h2"},"Insert One")),(0,o.kt)("p",null,"With Insert One, you can choose to insert a new row in an existing spreadsheet or add a new spreadsheet."),(0,o.kt)("h3",{id:"insert-a-new-spreadsheet"},(0,o.kt)("strong",{parentName:"h3"},"Insert a new Spreadsheet")),(0,o.kt)("p",null,"When you select to add a new spreadsheet, the new spreadsheet is created and available in your google account. When adding a new spreadsheet, you can also choose to add data to it."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/eSZyxR3vAj4?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Insert a Spreadsheet"))),(0,o.kt)("p",null,"For creating a spreadsheet and adding data to it, you can set the parameter values as below:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#operation"},"Operation")," - Insert One"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Spreadsheet"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#spreadsheet"},"Spreadsheet")," - Add the name you want to give to the spreadsheet. For example, ",(0,o.kt)("inlineCode",{parentName:"li"},"AppsmithEmployeeDirectory")),(0,o.kt)("li",{parentName:"ul"},"Row Objects - For adding data to the spreadsheet, you\u2019ll have to add the data in the form of a JSON Array. For example, you want to add the existing employee records to the sheet.")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The ",(0,o.kt)("strong",{parentName:"p"},"first insert")," to a ",(0,o.kt)("strong",{parentName:"p"},"blank")," sheet will also define the ",(0,o.kt)("strong",{parentName:"p"},"Sheet Schema")," - the column headers. If you wish to ",(0,o.kt)("strong",{parentName:"p"},"add more columns"),", you\u2019ll have to ",(0,o.kt)("strong",{parentName:"p"},"add the column names")," ",(0,o.kt)("strong",{parentName:"p"},"manually")," to the sheet. If the column names are ",(0,o.kt)("strong",{parentName:"p"},"not")," present in the sheet, the subsequent inserts will ",(0,o.kt)("strong",{parentName:"p"},"ignore")," the data for the ",(0,o.kt)("strong",{parentName:"p"},"additional")," columns even if supplied in the JSON.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'[\n    "rowIndex" : 1,\n    "id": "EMP001",\n    "FullName": "Alex D",\n    "Experience": "15.5 years",\n    "Designation": "Head of Technology",\n    "JoiningDateTime": "2022-05-12T09:07:57.000Z"\n  },\n  {\n    "rowIndex" : 2,\n    "id": "EMP002",\n    "FullName": "Darren L",\n    "Experience": "10.5 years",\n    "Designation": "Senior Manager - Sales"\n    "JoiningDateTime": "2012-05-12T09:07:57.000Z"\n  }\n]\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"You\u2019ll have to supply ",(0,o.kt)("inlineCode",{parentName:"p"},"rowIndex")," when creating a new spreadsheet and adding data.")),(0,o.kt)("h3",{id:"insert-new-row-to-sheet"},"Insert new row to Sheet"),(0,o.kt)("p",null,"You have a form that you use to capture the employee details. Whenever a new employee joins, you want to use that form and add the details to the existing spreadsheet ",(0,o.kt)("inlineCode",{parentName:"p"},"AppsmithEmployeeDirectory"),"."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/QMB8O2bBTqE?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Add New Data to an Existing Sheet"))),(0,o.kt)("p",null,"You\u2019ll have to add a query to insert the data by setting parameters as below:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#operation"},"Operation")," - Insert One"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Sheet Row(s)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#spreadsheet"},"Spreadsheet")," - Select the name of the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"AppsmithEmployeeDirectory")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#sheet-name"},"Sheet Name")," - Select the name of the Sheet ",(0,o.kt)("inlineCode",{parentName:"li"},"Sheet1")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#table-heading-row-index"},"Table Heading Row Index")," - Keep the default value that is 1"),(0,o.kt)("li",{parentName:"ul"},"Row Objects - For adding data to the spreadsheet, you\u2019ll have to add the data in JSON format as shown in the below code snippet:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "id": "EMP005",\n    "FullName" : "Karren L",\n    "Experience" : "6 years",\n    "Designation" : "Senior Sales Manager",\n    "JoiningDateTime" : "2022-06-28T09:51:48.127Z"\n}\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"You can use the above JSON to test the Query execution.")),(0,o.kt)("p",null,"To capture the user input, you can create a ",(0,o.kt)("a",{parentName:"p",href:"/appsmith-docs/reference/widgets/form"},"form")," as shown in the screenshot below and bind the query execution on the ",(0,o.kt)("inlineCode",{parentName:"p"},"onClick")," event of a ",(0,o.kt)("strong",{parentName:"p"},"Submit")," button."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Bind query execution to Submit",src:a(4005).Z,width:"2780",height:"970"})),(0,o.kt)("p",null,"You can modify the ",(0,o.kt)("strong",{parentName:"p"},"Row Objects JSON data")," to capture the values from the ",(0,o.kt)("a",{parentName:"p",href:"/appsmith-docs/reference/widgets/form"},"form"),", as shown in the code snippet below:"),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"You\u2019ll have to add quotes to the string values if the ",(0,o.kt)("a",{parentName:"p",href:"./../../core-concepts/connecting-to-data-sources/authentication/#smart-json-substitution"},"Smart JSON Substitution")," is turned off in the ",(0,o.kt)("inlineCode",{parentName:"p"},"settings")," tab.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "id": {{Employee.data.EmployeeCode}},\n    "FullName" : {{Employee.data.NameOfEmployee}},\n    "Experience" : {{Employee.data.ExperienceInYears}},\n    "Designation" : {{Employee.data.EmployeeDesignation}},\n    "JoiningDateTime" : {{Employee.data.EmployeeDOJ}}\n}\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"You can read the child widget data embedded in the form widget using ",(0,o.kt)("inlineCode",{parentName:"p"},"{{<FORM_NAME.data.CHILD_WIDGET_NAME>}}")," in a mustache ",(0,o.kt)("inlineCode",{parentName:"p"},"{{}}")," sign.")),(0,o.kt)("p",null,"When the user inputs an employee\u2019s data, and clicks the ",(0,o.kt)("inlineCode",{parentName:"p"},"Submit")," button, the query executes, and data is added to the existing sheet ",(0,o.kt)("inlineCode",{parentName:"p"},"Sheet1")," of the ",(0,o.kt)("inlineCode",{parentName:"p"},"AppsmithEmployeeDirectory.")),(0,o.kt)("h2",{id:"update-one"},"Update One"),(0,o.kt)("p",null,"With Update One, you can choose to update a single record in an existing spreadsheet."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/-zgd0LmzZ6c?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Update Row in an Existing Sheet"))),(0,o.kt)("p",null,"You can capture the data you want to update and send it to the update one query. For example, you want to update the designation and experience of an employee. You can pass the below parameters to the ",(0,o.kt)("strong",{parentName:"p"},"Update One")," Query."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#operation"},"Operation")," - Update One"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Sheet Row(s)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#spreadsheet"},"Spreadsheet")," - Select the name of the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"AppsmithEmployeeDirectory")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#sheet-name"},"Sheet Name")," - Select the name of the Sheet ",(0,o.kt)("inlineCode",{parentName:"li"},"Sheet1")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#table-heading-row-index"},"Table Heading Row Index")," - Keep the default value that is 1"),(0,o.kt)("li",{parentName:"ul"},"Row Objects - For updating data to the spreadsheet, you\u2019ll have to add the data in JSON format as shown in the below code snippet:")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"You should supply the value of ",(0,o.kt)("strong",{parentName:"p"},"rowIndex")," when ",(0,o.kt)("strong",{parentName:"p"},"updating")," the data. You get the value of ",(0,o.kt)("strong",{parentName:"p"},"rowIndex")," when you ",(0,o.kt)("strong",{parentName:"p"},"fetch the data")," from a ",(0,o.kt)("strong",{parentName:"p"},"sheet")," by using",(0,o.kt)("a",{parentName:"p",href:"/appsmith-docs/reference/datasources/querying-google-sheets#fetch-many"}," ",(0,o.kt)("strong",{parentName:"a"},"Fetch Many")),".")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "rowIndex" : 4,\n    "Experience" : {{Employee.data.ExperienceInYears}},\n    "Designation" : {{Employee.data.EmployeeDesignation}}\n}\n')),(0,o.kt)("p",null,"You can also choose to update all the data columns if needed."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The ",(0,o.kt)("strong",{parentName:"p"},"row to be updated")," is a calculated entity using the formula (",(0,o.kt)("inlineCode",{parentName:"p"},"Row Index")," + ",(0,o.kt)("inlineCode",{parentName:"p"},"Table Heading Row Index")," + ",(0,o.kt)("inlineCode",{parentName:"p"},"Modifier for the 0 indexed Google Sheet"),"). The modifier for the 0 indexed Google Sheet is a constant set to 1.")),(0,o.kt)("p",null,"The calculated to be updated row index will be ",(0,o.kt)("inlineCode",{parentName:"p"},"(4 + 1 + 1) = 6"),"."),(0,o.kt)("h2",{id:"delete-one"},"Delete One"),(0,o.kt)("p",null,"You can perform the Delete One operation to delete a spreadsheet, a sheet within a spreadsheet, or a row from the sheet."),(0,o.kt)("h3",{id:"delete-a-spreadsheet"},"Delete a Spreadsheet"),(0,o.kt)("p",null,"To delete a spreadsheet, you can choose the below parameters:"),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/rfD4IgcXtOg?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Delete a Spreadsheet"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#operation"},"Operation")," - Delete One"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Spreadsheet"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#spreadsheet"},"Spreadsheet")," - Select the name of the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"TestDeletion"),". You can also supply the URL for the spreadsheet by enabling the JS label.")),(0,o.kt)("h3",{id:"delete-a-sheet"},"Delete a Sheet"),(0,o.kt)("p",null,"You can choose to delete a sheet from the given spreadsheet. You can choose the below parameters:"),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/kW45AZoMkm4?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Delete a Sheet"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#operation"},"Operation")," - Delete One"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Sheet"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#spreadsheet"},"Spreadsheet")," - Select the name of the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"TestSheetDeletion"),". You can also supply the URL for the spreadsheet by enabling the JS label."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#sheet-name"},"Sheet Name "),"- Select the sheet name you want to delete from the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"Sheet1"),".")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The ",(0,o.kt)("inlineCode",{parentName:"p"},"Delete One")," operation for a Sheet only works when there is more than one sheet in the spreadsheet.")),(0,o.kt)("h3",{id:"delete-a-sheet-row"},"Delete a Sheet Row"),(0,o.kt)("p",null,"You can choose to delete a row from the existing sheet from the given spreadsheet. You can choose the below parameters:"),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/vE5PrkFd0y0?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Delete a Row"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Operation - Delete One"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Sheet Row(s)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#spreadsheet"},"Spreadsheet")," - Select the name of the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"AppsmithEmployeeDirectory"),". You can also supply the URL for the spreadsheet by enabling the JS label."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#sheet-name"},"Sheet Name")," - Select the sheet name you want to delete from the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"Sheet1"),"."),(0,o.kt)("li",{parentName:"ul"},"Row Index - If you want to delete the row 5 data in the Google Sheet, you should supply the Row Index as 3.")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The row to be deleted is a calculated entity using the formula (",(0,o.kt)("inlineCode",{parentName:"p"},"Row Index")," + ",(0,o.kt)("inlineCode",{parentName:"p"},"Table Heading Row Index")," + ",(0,o.kt)("inlineCode",{parentName:"p"},"Modifier for the 0 indexed Google Sheet"),"). The modifier for the 0 indexed Google Sheet is a constant set to 1.")),(0,o.kt)("p",null,"The calculated to be deleted row index will be ",(0,o.kt)("inlineCode",{parentName:"p"},"(3 + 1 + 1) = 5.")),(0,o.kt)("h2",{id:"fetch-many"},"Fetch Many"),(0,o.kt)("p",null,"You can choose to fetch multiple records from a sheet or fetch spreadsheets available in your Google account by using Fetch Many."),(0,o.kt)("h3",{id:"fetch-many-spreadsheet"},"Fetch Many Spreadsheet"),(0,o.kt)("p",null,"To fetch spreadsheets available in your account, you can choose the below parameters:"),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/uVmVKySPN_A?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Fetch all Spreadsheets"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#operation"},"Operation")," - Fetch Many"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Spreadsheet")),(0,o.kt)("p",null,"You can display the data by binding it to a widget. For example, you want to display the spreadsheets in a select widget. For this, you\u2019ll have to add a JS Object function in which you\u2019ll traverse through the response generated by the query and create an array of objects with label and value as a key and a value pair, as shown below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'export default {\n    getSpreadsheetNames: () => {\n        return fetchAllSpreadsheets.data.map((spreadsheet) => {\n            return {\n                "label": spreadsheet.name,\n                "value" : spreadsheet.id\n            }\n        })\n    }\n}\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Bind the data returned by the JS object to the select widget by using ",(0,o.kt)("inlineCode",{parentName:"p"},"{{<JS_OBJECT_NAME.FUNCTION_NAME()>}}")," embedded in a mustache ",(0,o.kt)("inlineCode",{parentName:"p"},"{{}}")," sign.")),(0,o.kt)("h3",{id:"fetch-many-sheet-rows"},"Fetch Many Sheet Rows"),(0,o.kt)("p",null,"To fetch spreadsheets data, you can choose the below parameters:"),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/KaagWQaR5wg?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Fetch Data from Sheet"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#operation"},"Operation")," - Fetch Many"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Sheet Row(s)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#spreadsheet"},"Spreadsheet")," - Select the name of the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"AppsmithEmployeeDirectory"),". You can also supply the URL for the spreadsheet by enabling the JS label."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#sheet-name"},"Sheet Name")," - Select the sheet name you want to delete from the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"Sheet1"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#table-heading-row-index"},"Table Heading Row Index")," - Keep the default value that is 1")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"You can choose to add filters using range or ",(0,o.kt)("inlineCode",{parentName:"p"},"where")," Clause.")),(0,o.kt)("p",null,"You can display the data by binding it to a ",(0,o.kt)("a",{parentName:"p",href:"/appsmith-docs/reference/widgets/"},"widget"),". For example, you can display the spreadsheet data in a ",(0,o.kt)("a",{parentName:"p",href:"/appsmith-docs/reference/widgets/table/"},"table")," widget."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Bind the data returned by the query to a ",(0,o.kt)("a",{parentName:"p",href:"/appsmith-docs/reference/widgets/table/"},"table")," widget - ",(0,o.kt)("a",{parentName:"p",href:"/widgets/table/#table-data"},"TableData")," property by using ",(0,o.kt)("inlineCode",{parentName:"p"},"{{<QUERY_NAME>.data>}}")," embedded in a mustache ",(0,o.kt)("inlineCode",{parentName:"p"},"{{}}")," sign.")),(0,o.kt)("h2",{id:"insert-many"},"Insert Many"),(0,o.kt)("p",null,"You can choose to insert multiple records in an existing sheet by using Insert Many."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/Mxlw_2U5PeA?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Add Multiple Rows to Sheet"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#operation"},"Operation")," - Insert Many"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Sheet Row(s)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#spreadsheet"},"Spreadsheet")," - Select the name of the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"AppsmithEmployeeDirectory"),". You can also supply the URL for the spreadsheet by enabling the ",(0,o.kt)("inlineCode",{parentName:"li"},"JS label"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#sheet-name"},"Sheet Name")," - Select the sheet name you want to insert to the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"Sheet1"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#table-heading-row-index"},"Table Heading Row Index")," - Keep the default value that is 1"),(0,o.kt)("li",{parentName:"ul"},"Row Objects - For inserting data to the spreadsheet, you\u2019ll have to add the data in JSON Array Format as shown in the below code snippet:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'[\n   {\n    "rowIndex" : 1,\n    "id": "EMP010",\n    "FullName": "Derrick D",\n    "Experience": "1.5 years",\n    "Designation": "Trainee Engineer",\n    "JoiningDateTime": "2022-05-12T09:07:57.000Z"\n  },\n  {\n    "rowIndex" : 2,\n    "id": "EMP011",\n    "FullName": "Tom L",\n    "Experience": "8 years",\n    "Designation": "Manager - Sales",\n    "JoiningDateTime": "2012-05-12T09:07:57.000Z"\n  }\n]\n\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"You can choose not to provide ",(0,o.kt)("strong",{parentName:"p"},"rowIndex"),", and inserts will still happen.")),(0,o.kt)("p",null,"You can also bind an API or a Query response returning a JSON Array to Row Objects by using ",(0,o.kt)("inlineCode",{parentName:"p"},"{{<QUERY/API_NAME>.data}}")," embedded in a mustache ",(0,o.kt)("inlineCode",{parentName:"p"},"{{}}")," sign."),(0,o.kt)("h2",{id:"update-many"},(0,o.kt)("strong",{parentName:"h2"},"Update Many")),(0,o.kt)("p",null,"You can choose to update multiple records in an existing sheet by using Update Many."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/i9B3yuKDtEc?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Update Multiple Rows in Sheet"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#operation"},"Operation")," - Update Many"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#entity"},"Entity")," - Sheet Row(s)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#spreadsheet"},"Spreadsheet")," - Select the name of the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"AppsmithEmployeeDirectory"),". You can also supply the URL for the spreadsheet by enabling the JS label."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#sheet-name"},"Sheet Name")," - Select the sheet name you want to update from the spreadsheet ",(0,o.kt)("inlineCode",{parentName:"li"},"Sheet1"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/appsmith-docs/reference/datasources/querying-google-sheets#table-heading-row-index"},"Table Heading Row Index")," - Keep the default value that is 1"),(0,o.kt)("li",{parentName:"ul"},"Row Objects - For updating data in the spreadsheet, you\u2019ll have to add the data in JSON Array Format as shown in the below code snippet:")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"You will have to provide ",(0,o.kt)("inlineCode",{parentName:"p"},"rowIndex"),", without which the updates will fail.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'[\n   {\n    "rowIndex" : 1,\n    "Experience": "3 years",\n    "Designation": "Junior Engineer"\n  },\n  {\n    "rowIndex" : 2,\n    "Experience": "10 years",\n    "Designation": "Senior Manager - Sales"\n  }\n]\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The row to be updated is a calculated entity using the formula (",(0,o.kt)("inlineCode",{parentName:"p"},"Row Index")," + ",(0,o.kt)("inlineCode",{parentName:"p"},"Table Heading Row Index")," + ",(0,o.kt)("inlineCode",{parentName:"p"},"Modifier for the 0 indexed Google Sheet"),"). The modifier for the 0 indexed Google Sheet is a constant set to 1.")),(0,o.kt)("p",null,"The calculated to be updated row index will be ",(0,o.kt)("inlineCode",{parentName:"p"},"(1 + 1 + 1) = 3"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"(2+1+1) = 4")," respectively."),(0,o.kt)("h2",{id:"common-settings"},(0,o.kt)("strong",{parentName:"h2"},"Common Settings")),(0,o.kt)("p",null,"There are a few settings listed below that are common to many operations that you will perform on the Google Sheets:"),(0,o.kt)("h3",{id:"entity"},(0,o.kt)("strong",{parentName:"h3"},"Entity")),(0,o.kt)("p",null,"You can select the type of entity that you want to perform the operation on:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Spreadsheet")," - When you want to perform the operation on Spreadsheet. For example, you want to create a new spreadsheet for every user\u2019s data input."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Sheet")," - When you want to perform the operation on a sheet already present in a spreadsheet. For example, you want to update some data in the existing sheet. Using Sheet as an entity, you can add a new sheet to an existing spreadsheet."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Sheet Rows")," - When you want to focus on inserting, updating, or deleting rows in an existing sheet, you can use Sheet Rows for the same.")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"All")," operations may ",(0,o.kt)("strong",{parentName:"p"},"not")," be available for every ",(0,o.kt)("strong",{parentName:"p"},"entity"),". For all the ",(0,o.kt)("strong",{parentName:"p"},"unsupported")," ",(0,o.kt)("strong",{parentName:"p"},"operations")," for that entity, you will see an ",(0,o.kt)("inlineCode",{parentName:"p"},"Action not supported")," tooltip when you try to select an Entity.")),(0,o.kt)("p",null,"Depending upon the type of operation and the entity selected, you'll have to provide the below details:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"You&#39;ll have to select the spreadsheet and the sheet name for sheet rows",src:a(29097).Z,width:"1933",height:"268"})),(0,o.kt)("h4",{id:"spreadsheet"},(0,o.kt)("strong",{parentName:"h4"},"Spreadsheet")),(0,o.kt)("p",null,"Provide the name of the spreadsheet you want to perform an operation on. You can also add the spreadsheet URL by enabling the JS label."),(0,o.kt)("h4",{id:"sheet-name"},(0,o.kt)("strong",{parentName:"h4"},"Sheet Name")),(0,o.kt)("p",null,"Select the sheet's name from the dropdown on which you want to perform an operation. You can also choose to add the name by enabling the JS label."),(0,o.kt)("h4",{id:"table-heading-row-index"},(0,o.kt)("strong",{parentName:"h4"},"Table Heading Row Index")),(0,o.kt)("p",null,"Enter the row index of the header row in a Google Sheet. Usually, it starts with 1, so the default value supplied to this field is 1. You can change it to the heading row index if needed."),(0,o.kt)("h4",{id:"columns"},(0,o.kt)("strong",{parentName:"h4"},"Columns")),(0,o.kt)("p",null,"You could provide the columns that you want to select for the query. The default setting is All Columns will be fetched. If you want to select only a few columns, you can do that by enabling the JS label and supplying the column names in a ",(0,o.kt)("a",{parentName:"p",href:"http://json-schema.org/draft-07/schema"},"JSON array format")," as below:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'["columnname1", "columnname2"]\n')),(0,o.kt)("p",null,"In the above code snippet, ",(0,o.kt)("inlineCode",{parentName:"p"},"columnname1")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"columnname2")," are the column names in the Google sheet."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Either select All columns or specific columns",src:a(70709).Z,width:"1844",height:"532"})),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The column names are ",(0,o.kt)("strong",{parentName:"p"},"case sensitive"),", and you should include ",(0,o.kt)("strong",{parentName:"p"},"trailing or leading spaces")," when ",(0,o.kt)("strong",{parentName:"p"},"adding")," the ",(0,o.kt)("strong",{parentName:"p"},"column names")," in JS if they are present in the Google Sheet.")),(0,o.kt)("h3",{id:"filter-format"},(0,o.kt)("strong",{parentName:"h3"},"Filter Format")),(0,o.kt)("p",null,"The filter format allows you to filter your Google sheet data based on range or data filters."),(0,o.kt)("h4",{id:"cell-range"},(0,o.kt)("strong",{parentName:"h4"},"Cell Range")),(0,o.kt)("p",null,"You can filter by range for cases when you want to fetch data from designated cells in your sheet. For example, you want to check the experience level and designations of the employees to create a data table that shows how many employees are eligible for a promotion. You can choose filter by cell range and select the designated columns excluding all the other details. Filter by cell range gives you the desired data set that works best for your use case."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/FC_7OKeRQQs?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Set Cell Range Filtering"))),(0,o.kt)("h4",{id:"where-clause"},(0,o.kt)("strong",{parentName:"h4"},"Where Clause")),(0,o.kt)("p",null,"By defining the column and the filter criteria, you can filter by the data available in columns. For example, you want to fetch all employees designated as ",(0,o.kt)("strong",{parentName:"p"},"project leaders"),". You can define the designation column as part of the Where clause and supply the filter value as ",(0,o.kt)("strong",{parentName:"p"},"Project Leader"),"."),(0,o.kt)("p",null,"You can define a where clause by defining the following values:"),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/hE0YHCdD4FY?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Confide Where Clause"))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Filter By")," - You define one or more criteria as part of the ",(0,o.kt)("inlineCode",{parentName:"li"},"filter by"),".",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Key")," - Specify the column names on which you would want to add filters"),(0,o.kt)("li",{parentName:"ul"},"Select the comparison operator to evaluate the condition"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Value")," - Specify the filter value which will be used to filter the data"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Add Condition")," - You can use it to add more conditions and select the \u201cAnd/or\u201d operator for evaluation"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Add Group Condition")," - You can add a group condition that uses an \u201cAnd\u201d clause to evaluate the conditions specified in the group."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Sort By")," - You can choose to sort the data based on the column name and provide the type of sorting: Ascending or Descending. You can choose to enable JS label and add your own code in ",(0,o.kt)("a",{parentName:"li",href:"http://json-schema.org/draft-07/schema"},"JSON Format")," :",(0,o.kt)("inlineCode",{parentName:"li"},'[ { "column": "columnName", "order": "Ascending" } ]')," For example, you want to sort the data on the employee\u2019s full name in ascending order. You can add the code for the sort by condition:",(0,o.kt)("inlineCode",{parentName:"li"},'[ { "column": "FullName", "order": "Ascending" } ]')),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Add Parameter")," - you can add more parameters to sort if you want to sort on more than one column."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Pagination Limit")," - You can set the number of pages to be displayed per page. By default, the value is set to 20. But you can change it as per your needs."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Pagination Offset")," - If you wish to skip some data, you can add the number of rows in the field. The number of rows specified will be skipped and will not be a part of the dataset returned as a result of query execution.")),(0,o.kt)("p",null,"You can also choose to write the Where Clause by enabling the JS label and adding the below code snippet in a ",(0,o.kt)("a",{parentName:"p",href:"http://json-schema.org/draft-07/schema"},"JSON Format")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n  "condition": "AND",\n  "children": [\n    {\n      "condition": "LT",\n      "key": "k1",\n      "value": "v1"\n    },\n    {\n      "key": "k2",\n      "condition": "LT",\n      "value": "v2"\n    },\n    {\n      "condition": "AND",\n      "children": [\n        {\n          "condition": "LT",\n          "key": "k3",\n          "value": "v3"\n        }\n      ]\n    }\n  ]\n}\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"As per your filter criteria, you can ",(0,o.kt)("strong",{parentName:"p"},"replace")," the ",(0,o.kt)("strong",{parentName:"p"},"key")," and ",(0,o.kt)("strong",{parentName:"p"},"value")," with the ",(0,o.kt)("strong",{parentName:"p"},"column names.")," You can also ",(0,o.kt)("strong",{parentName:"p"},"add"),", ",(0,o.kt)("strong",{parentName:"p"},"replace")," or ",(0,o.kt)("strong",{parentName:"p"},"remove")," ",(0,o.kt)("strong",{parentName:"p"},"conditions")," based on ",(0,o.kt)("strong",{parentName:"p"},"filtering")," needs.")),(0,o.kt)("p",null,"For example, you want to fetch all the employees with designation as ",(0,o.kt)("strong",{parentName:"p"},"Junior Engineer.")," You can write a where clause as below and enable the ",(0,o.kt)("inlineCode",{parentName:"p"},"JS label")," for the ",(0,o.kt)("inlineCode",{parentName:"p"},"Filter By")," and add it to the text field."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "condition": "AND",\n    "children": [\n        {\n            "condition": "EQ",\n            "key": "Designation",\n            "value": "Junior Engineer"\n        }\n    ]\n}\n')),(0,o.kt)("p",null,"If you now want to fetch all employees with designation as ",(0,o.kt)("strong",{parentName:"p"},"Junior Engineer")," and have experience of ",(0,o.kt)("strong",{parentName:"p"},"3 years"),", then the code for conditions will be as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "condition": "AND",\n    "children": [\n        {\n            "condition": "EQ",\n            "key": "Designation",\n            "value": "Junior Engineer"\n        },\n        {\n            "key": "Experience",\n            "condition": "EQ",\n            "value": "3 years"\n        }\n    ]\n}\n')),(0,o.kt)("h3",{id:"using-queries-in-applications"},(0,o.kt)("strong",{parentName:"h3"},"Using Queries in applications")),(0,o.kt)("p",null,"Once you have successfully run a Query, you can use it in your application to"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"./../../core-concepts/data-access-and-binding/displaying-data-read/"},"Display Data")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"./../../core-concepts/data-access-and-binding/capturing-data-write/"},"Capture Data"))))}h.isMDXComponent=!0},29097:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Datasources__Google_Sheets__Common_Settings__Entity__Spreadsheet-8ce82dd16dfb86be86e48adf73174c19.png"},70709:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Datasources__Google_Sheets__Common_Settings__Entity__Spreadsheet__Columns-1a4d044064473e5dbd0e0eca336346fa.png"},4005:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/Datasources__Google_Sheets__Insert_One__Capture_Data_from_Form_Widget-cd1ca7dc83e0051f0e2182d60eeb8f8b.png"},53955:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/google_sheets_scope-15c24f68aec7dc63e76e920f7af0422a.png"}}]);