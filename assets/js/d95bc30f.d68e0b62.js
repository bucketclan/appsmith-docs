"use strict";(self.webpackChunkappsmith_docs=self.webpackChunkappsmith_docs||[]).push([[501],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=d(n),h=o,m=u["".concat(s,".").concat(h)]||u[h]||c[h]||i;return n?a.createElement(m,r(r({ref:t},p),{},{components:n})):a.createElement(m,r({ref:t},p))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var d=2;d<i;d++)r[d]=n[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},83365:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var a=n(87462),o=(n(67294),n(3905));const i={sidebar_position:6},r="Firestore",l={unversionedId:"reference/datasources/querying-firestore",id:"reference/datasources/querying-firestore",title:"Firestore",description:"On Appsmith, it's pretty straightforward to establish a connection with any datasource, including Firestore.",source:"@site/docs/reference/datasources/querying-firestore.md",sourceDirName:"reference/datasources",slug:"/reference/datasources/querying-firestore",permalink:"/appsmith-docs/reference/datasources/querying-firestore",draft:!1,editUrl:"https://github.com/bucketclan/appsmith-docs/blob/v1.5/website/docs/reference/datasources/querying-firestore.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Elasticsearch",permalink:"/appsmith-docs/reference/datasources/querying-elasticsearch"},next:{title:"Google Sheets",permalink:"/appsmith-docs/reference/datasources/querying-google-sheets"}},s={},d=[{value:"Connecting Firestore on Appsmith",id:"connecting-firestore-on-appsmith",level:2},{value:"Fetching Project ID",id:"fetching-project-id",level:4},{value:"Fetching Database URL",id:"fetching-database-url",level:4},{value:"Fetching Service Account Credentials",id:"fetching-service-account-credentials",level:4},{value:"Understanding Commands",id:"understanding-commands",level:2},{value:"Fetching Data",id:"fetching-data",level:2},{value:"Fetching Single Document",id:"fetching-single-document",level:3},{value:"Fetching Multiple Documents",id:"fetching-multiple-documents",level:3},{value:"Adding New Document(s)",id:"adding-new-documents",level:2},{value:"<strong>Set Document</strong>",id:"set-document",level:3},{value:"Create Document",id:"create-document",level:3},{value:"Add Document to Collection",id:"add-document-to-collection",level:3},{value:"Updating a Document",id:"updating-a-document",level:2},{value:"Deleting Document",id:"deleting-document",level:2},{value:"Server-side Pagination",id:"server-side-pagination",level:2},{value:"Using Queries in applications",id:"using-queries-in-applications",level:2}],p={toc:d};function c(e){let{components:t,...i}=e;return(0,o.kt)("wrapper",(0,a.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"firestore"},"Firestore"),(0,o.kt)("p",null,"On Appsmith, it's pretty straightforward to establish a connection with any datasource, including Firestore."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"The following document assumes that you understand the ",(0,o.kt)("a",{parentName:"p",href:"/appsmith-docs/core-concepts/connecting-to-data-sources/connecting-to-databases#connecting-to-a-database"},"basics of connecting to databases on Appsmith"),". If not, please go over them before reading further.")),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://firebase.google.com/docs/firestore"},"Firestore")," is a NoSQL document database built for automatic scaling, high performance, and ease of application development. While the Firestore interface has many features like traditional databases, as a NoSQL database, it differs from describing relationships between data objects."),(0,o.kt)("p",null,"What we need to make the connection are the Database URL, Project Id, and Service Account Credentials. With this in mind, let's get started."),(0,o.kt)("h2",{id:"connecting-firestore-on-appsmith"},"Connecting Firestore on Appsmith"),(0,o.kt)("p",null,"The Firestore plugin requires three pieces of information to connect to Firestore."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"On your Appsmith application, click on the ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"+"))," icon next to ",(0,o.kt)("strong",{parentName:"li"},"Datasources")," on the left navigation bar under Page1."),(0,o.kt)("li",{parentName:"ul"},"Now, navigate to the Create New tab and choose ",(0,o.kt)("strong",{parentName:"li"},"Firestore data source"),"; you'll see the following screenshot:")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Firestore Database Page",src:n(5112).Z,width:"3584",height:"2086"})),(0,o.kt)("p",null,"The above details are available from the Firebase Console. Let's fetch each one of them:"),(0,o.kt)("h4",{id:"fetching-project-id"},"Fetching Project ID"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Next to the project overview option, click the ",(0,o.kt)("strong",{parentName:"li"},"setting gear"),"."),(0,o.kt)("li",{parentName:"ol"},"In the ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Project Settings")),' ensure you\'re in the "General" tab.'),(0,o.kt)("li",{parentName:"ol"},"You'll find an ",(0,o.kt)("inlineCode",{parentName:"li"},"Project ID")," entry with a value."),(0,o.kt)("li",{parentName:"ol"},"Copy this value into the Project ID field in the Firestore configuration.")),(0,o.kt)("h4",{id:"fetching-database-url"},"Fetching Database URL"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The Database URL need to be formed using the Firebase ",(0,o.kt)("em",{parentName:"li"},"project ID")," you found above in the following manner ",(0,o.kt)("inlineCode",{parentName:"li"},"your-project-id.firebaseio.com"))),(0,o.kt)("h4",{id:"fetching-service-account-credentials"},"Fetching Service Account Credentials"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Firebase Service Account Credentials",src:n(69311).Z,width:"3074",height:"1704"})),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Go to ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Project Settings"))," and click on the ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Service Accounts Tab."))),(0,o.kt)("li",{parentName:"ol"},"On the service accounts tab, below the code snippet, there is a ",(0,o.kt)("strong",{parentName:"li"},"Generate new private key")," button."),(0,o.kt)("li",{parentName:"ol"},"Clicking this button will generate a new private key with access to this Firestore instance."),(0,o.kt)("li",{parentName:"ol"},"This key will be in the form of a JSON file which will be downloaded when you click this button."),(0,o.kt)("li",{parentName:"ol"},"Copy the ",(0,o.kt)("strong",{parentName:"li"},"contents")," of this file and paste them into the ",(0,o.kt)("strong",{parentName:"li"},"Service Account Credentials")," field in appsmith."),(0,o.kt)("li",{parentName:"ol"},"Next, click on the ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Test"))," button at the bottom right of the screen. This will help you with understanding whether your configuration is valid or not. If it returns a successful message, hit the 'Save' button to establish a secure connection between Appsmith and Firestore.")),(0,o.kt)("p",null,"The video below explains how to connect to Firestore."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/6hpMy2s-xDQ?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Connecting Firestore on Appsmith"))),(0,o.kt)("h2",{id:"understanding-commands"},"Understanding Commands"),(0,o.kt)("p",null,"Now that we've successfully connected to Firestore, let's look at how to query the data. First, let's fetch our data from firestore."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Note: All the commands function mentioned below can be found on the query page.Fetching Single Document")),(0,o.kt)("h2",{id:"fetching-data"},"Fetching Data"),(0,o.kt)("p",null,"First, let's read our data from the database and display it."),(0,o.kt)("p",null,"There are two methods for fetching data from Firestore: one for fetching a single document by a path and the second for fetching multiple documents from a collection by a path."),(0,o.kt)("h3",{id:"fetching-single-document"},"Fetching Single Document"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Click on the ",(0,o.kt)("strong",{parentName:"li"},"datasources")," and choose the database you created."),(0,o.kt)("li",{parentName:"ul"},"Rename the query."),(0,o.kt)("li",{parentName:"ul"},"From the ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Commands"))," drop-down, Select the method ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Get Single Document")),"."),(0,o.kt)("li",{parentName:"ul"},"Next, set the path to the full path of the document you want to load. The path should be provided ",(0,o.kt)("strong",{parentName:"li"},"without")," any leading or trailing/characters.")),(0,o.kt)("p",null,"For example, setting the path to users/",(0,o.kt)("a",{parentName:"p",href:"mailto:sherlock@gmail.com"},"sherlock@gmail.com")," will get the document with ID ",(0,o.kt)("a",{parentName:"p",href:"mailto:sherlock@gmail.com"},"sherlock@gmail.com")," inside the collection users."),(0,o.kt)("p",null,"Below is a video that shows how you can fetch a single document from the firestore. The below example fetches task details. Here the number represents the issue ID. As a result, ",(0,o.kt)("strong",{parentName:"p"},"task/issue_id")," provides information about that specific issue."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/RdieZyfXLfs?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Fetching Single Document"))),(0,o.kt)("h3",{id:"fetching-multiple-documents"},"Fetching Multiple Documents"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Click on the ",(0,o.kt)("inlineCode",{parentName:"li"},"datasources")," and choose the database you created."),(0,o.kt)("li",{parentName:"ul"},"Rename the query."),(0,o.kt)("li",{parentName:"ul"},"Set the query command to ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Get Documents"))," in the Collection."),(0,o.kt)("li",{parentName:"ul"},"Set the ",(0,o.kt)("inlineCode",{parentName:"li"},"Collection/Document Path *")," to the collection name."),(0,o.kt)("li",{parentName:"ul"},"This simple query returns all the task details in the sample data item. Hit the ",(0,o.kt)("strong",{parentName:"li"},"RUN")," button to view all the results.")),(0,o.kt)("p",null,"The video below shows how you can fetch multiple documents from the firestore. The example below fetches all the documents from a collection."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/nuc18ARTfGk?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Fetching Multiple Document"))),(0,o.kt)("p",null,"We now have our query; let's bind this onto the table widget; for this, follow the below steps:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Click on the ",(0,o.kt)("inlineCode",{parentName:"li"},"+")," icon next to widgets on the sidebar, search for the ",(0,o.kt)("strong",{parentName:"li"},"table widget"),", and drag and drop it onto the canvas."),(0,o.kt)("li",{parentName:"ul"},"You can make any configurations to any widget via the property pane. Click on the table widget on the canvas; you will see the property pane docked to the sidebar on the right. Now, under the Table Data property, use the moustache syntax to bind the query:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"{{getTasks.data}}\n")),(0,o.kt)("p",null,"Let's look at how to personalize your query:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Order By"),": Set this to a JSON array of field names or field paths by which the documents should be sorted. For example, if in the given collection, you have the document ",(0,o.kt)("inlineCode",{parentName:"p"},'{"name": "Sherlock", "role": "Detective"}')," and ",(0,o.kt)("inlineCode",{parentName:"p"},'{"name": "Watson", "role": "Doctor"}'),", then specifying ",(0,o.kt)("inlineCode",{parentName:"p"},'["name"]')," in the Order By input will return the documents ordered by the name field in each document. Additionally, any field or path can be prefixed with a ",(0,o.kt)("inlineCode",{parentName:"p"},"-")," to order that field in descending order. So specifying ",(0,o.kt)("inlineCode",{parentName:"p"},'["name", "-role"]')," would sort by the ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," field in ascending order and by the",(0,o.kt)("inlineCode",{parentName:"p"},"role")," field in descending order."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Limit Documents"),": This field is a number that specifies the maximum number of documents fetched by the query. Setting this to a ",(0,o.kt)("em",{parentName:"p"},"very")," high number may impact the performance of your application, but the impact and how high will depend on the size of the documents being fetched."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Where Condition"),": This is a set of three fields that allow you to apply a filter on the documents being fetched. The first field ",(0,o.kt)("strong",{parentName:"p"},"Field Path")," is the path of a nested field on which to apply the filter. Example values are ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"name.first")," if the documents look like ",(0,o.kt)("inlineCode",{parentName:"p"},'{"name": {"first": "Sherlock", "last": "Holmes"}}'),"."),(0,o.kt)("p",null,"The second field is the operator and the third is the value to apply the filter with. For array operators like in, the value can be set to a valid JSON-serialized array. For example, the field path can be ",(0,o.kt)("inlineCode",{parentName:"p"},"name"),", the operator can be ",(0,o.kt)("inlineCode",{parentName:"p"},"in")," and the value can be ",(0,o.kt)("inlineCode",{parentName:"p"},'["Sherlock", "Mycroft"]'),". This will filter all documents with a ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," field set to either ",(0,o.kt)("inlineCode",{parentName:"p"},'"Sherlock"')," or ",(0,o.kt)("inlineCode",{parentName:"p"},'"Mycroft"'),"."),(0,o.kt)("h2",{id:"adding-new-documents"},"Adding New Document(s)"),(0,o.kt)("p",null,"There are three methods to add documents to a collection, depending on the behaviour required."),(0,o.kt)("h3",{id:"set-document"},(0,o.kt)("strong",{parentName:"h3"},"Set Document")),(0,o.kt)("p",null,"This method will set the given document at the given document path. If a document already exists at the given path, it will be overridden. It will create a path for the document if it does not exist at the given path."),(0,o.kt)("p",null,"The ",(0,o.kt)("strong",{parentName:"p"},"set document")," command can create or update an existing document. It requires a ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"collection-name/doc-id")),"."),(0,o.kt)("p",null,"Let\u2019s look at an example to see how a ",(0,o.kt)("inlineCode",{parentName:"p"},"set document")," works."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Click on the ",(0,o.kt)("strong",{parentName:"li"},"datasources")," and choose the database you created."),(0,o.kt)("li",{parentName:"ul"},"Rename the query."),(0,o.kt)("li",{parentName:"ul"},"Set the query command to \u201c",(0,o.kt)("inlineCode",{parentName:"li"},"Set Documents"),"\u201d in the Collection."),(0,o.kt)("li",{parentName:"ul"},"Now, add the collection and document details."),(0,o.kt)("li",{parentName:"ul"},"Here we will add ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"tasks/newdoc")),". In the body section we will add something like:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "name":"{{Input2Copy.text}}",\n    "assigned_to": "{{Input3Copy.text}}"\n}\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Now hit \u201c",(0,o.kt)("strong",{parentName:"li"},"RUN"),"\u201d.")),(0,o.kt)("p",null,"If the defined doc-id doesn\u2019t exist, it creates a new doc with the id. So here in the firestore, it will create a new document. The image below depicts the same."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(38540).Z,width:"966",height:"242"})),(0,o.kt)("h3",{id:"create-document"},"Create Document"),(0,o.kt)("p",null,"This method will set the given document at the given document path. If a document already exists at the given path, this method will fail, and the given document is not saved. A new path will be created if the document doesn\u2019t exist on that path."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Let's look at an example")," to see how to create a new document. Let\u2019s assume you have a table which displays data from firestore. Now let's add a modal, to update the value to the database."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("a",{parentName:"p",href:"/widgets/modal.md"},"Modal "),"is a simple UI widget you can use when you want to create Dialogs, Popovers or Alerts.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Drag and drop a button widget onto the canvas. Open its property pane, set the onClick property to ",(0,o.kt)("strong",{parentName:"li"},"Open a New Modal"),", and choose to ",(0,o.kt)("strong",{parentName:"li"},"Create New.")),(0,o.kt)("li",{parentName:"ul"},"This will open up a new modal now; let's drag and drop a few widgets to create a form that we can use to add a new task to our database.")),(0,o.kt)("p",null,"Now that the modal\u2019s UI is ready, let's connect it:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Click on the + icon next to the datasources and choose to Create New + from the Firestore datasource."),(0,o.kt)("li",{parentName:"ul"},"Rename the query to ",(0,o.kt)("inlineCode",{parentName:"li"},"createTask"),"."),(0,o.kt)("li",{parentName:"ul"},"Set the commands to ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Create Document."))),(0,o.kt)("li",{parentName:"ul"},"Set the ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Collection/Document Path *"))," to ",(0,o.kt)("inlineCode",{parentName:"li"},"collection_name/{{Math.random().toString().substring()}}"))),(0,o.kt)("p",null,"For Example:- ",(0,o.kt)("inlineCode",{parentName:"p"},"tasks/{{Math.random().toString(36).substring(7)}}")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Finally, set the body property.")),(0,o.kt)("p",null,"For example, you can set a body property like this to collect all the information from the modal widget:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "name":"{{Input1.text}}",\n    "deadline": "{{DatePicker1.formattedDate}}",\n    "issue_id": "{{Input2.text}}",\n    "complete": false\n}\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Here, we have an insert query that collects all the data from the form widgets we've created. Note that we use the mustache syntax to bind the data from the widgets onto the query body.")),(0,o.kt)("p",null,"Lastly, we\u2019ll need to configure the submit button; for this, go back to the modal and set the button\u2019s onClick property to execute a query and choose ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"createTask"))," under the events property:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Modal example to create a new document on firestore.",src:n(59172).Z,width:"1598",height:"862"})),(0,o.kt)("p",null,"You can check out this ",(0,o.kt)("a",{parentName:"p",href:"https://appsmith.hashnode.dev/build-a-crud-app-with-a-firestore-database"},"tutorial"),", to learn more about creating the document."),(0,o.kt)("h3",{id:"add-document-to-collection"},"Add Document to Collection"),(0,o.kt)("p",null,"This method will add the given document with an auto-generated document-id, into the given collection path. Note that the given path must point to a collection in this method. If the collection doesn't exist at the given path, it will be created."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Let\u2019s look at an example")," to see how ",(0,o.kt)("inlineCode",{parentName:"p"},"add the document to collection")," works:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Click on the ",(0,o.kt)("strong",{parentName:"li"},"datasources")," and choose the database you created."),(0,o.kt)("li",{parentName:"ul"},"Rename the query."),(0,o.kt)("li",{parentName:"ul"},"Set the query command to \u201c",(0,o.kt)("strong",{parentName:"li"},"Add Documents to Collection"),"\u201d in the Collection."),(0,o.kt)("li",{parentName:"ul"},"Now, just add your ",(0,o.kt)("inlineCode",{parentName:"li"},"collection-name"),"."),(0,o.kt)("li",{parentName:"ul"},"Here we will add ",(0,o.kt)("inlineCode",{parentName:"li"},"tasks"),"."),(0,o.kt)("li",{parentName:"ul"},"Now in the body, add your details:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "name":"{{Input2Copy.text}}",\n    "assigned_to": "{{Input3Copy.text}}"\n}\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Now hit ",(0,o.kt)("strong",{parentName:"li"},"Run"),".")),(0,o.kt)("p",null,"A new unique document with the above-mentioned details will be generated in the firestore."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"All three methods above take a path and a body as inputs. The path is interpreted as described above and the body is expected to contain a valid JSON-serialized object which will make up the document to be used in operation (as described above).")),(0,o.kt)("h2",{id:"updating-a-document"},"Updating a Document"),(0,o.kt)("p",null,'The "Update Document" method can be used to surgically update only certain fields in a document while leaving the rest of the document as is. It takes the document path pointing to the document that should be updated and a body of changes. For example, if the body is set to the following:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n    "name": "Eve"\n}\n')),(0,o.kt)("p",null,"Then the value of the ",(0,o.kt)("inlineCode",{parentName:"p"},"name")," field in the document pointed by path will be changed to ",(0,o.kt)("inlineCode",{parentName:"p"},'"Eve"'),", but no other fields in the document will be changed."),(0,o.kt)("p",null,"Values of nested fields should be set in the form of field paths. For example, consider the following document that's already saved in our Firestore:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n    "name": {\n        "first": "Sherlock",\n        "last": "Holmes"\n    },\n    "role": "Detective"\n}\n')),(0,o.kt)("p",null,"Say we want to update the first name to ",(0,o.kt)("inlineCode",{parentName:"p"},'"Mycroft"'),", but leave the rest of the document (including the last name) intact. Then the body in the update method should be:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'{\n    "name.first": "Mycroft"\n}\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Note that this method can only update a single document at once. Firestore doesn't provide a way to bulk-update multiple documents at once.")),(0,o.kt)("p",null,"Let's look at an example to learn more about updating the document."),(0,o.kt)("p",null,"The Update operation is quite similar to the create operation."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Let\u2019s build UI by creating a new custom column on the table by clicking on ",(0,o.kt)("strong",{parentName:"li"},"ADD A NEW COLUMN")," under the columns property."),(0,o.kt)("li",{parentName:"ul"},"Now, rename the column to ",(0,o.kt)("strong",{parentName:"li"},"Edit"),", and click on the cog icon next to it, to configure column settings."),(0,o.kt)("li",{parentName:"ul"},"Under this, we\u2019ll see column-type properties set to a Button type. A modal should open up the necessary fields to update the item when clicked."),(0,o.kt)("li",{parentName:"ul"},"Now, copy-paste Modal1, rename it to Modal2 and set the onClick property of the Edit Task button to open Modal2."),(0,o.kt)("li",{parentName:"ul"},"Here, in the form, we can also set the default value to show existing information, to display this, use the ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"selectedRow"))," property from the table widget.")),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(28647).Z,width:"3584",height:"2086"})),(0,o.kt)("p",null,"Let\u2019s write the Edit query:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Click on the ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"+"))," icon next to the datasources and choose to Create New + from the Firestore datasource."),(0,o.kt)("li",{parentName:"ul"},"Rename the query to ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"editTask")),"."),(0,o.kt)("li",{parentName:"ul"},"Set the ",(0,o.kt)("inlineCode",{parentName:"li"},"Collection/Document Path*")," to ",(0,o.kt)("inlineCode",{parentName:"li"},"tasks/{{Table1.selectedRow._ref}}.")),(0,o.kt)("li",{parentName:"ul"},"Finally, set the body property to:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n    "name":"{{Input1Copy.text}}",\n    "deadline": "{{DatePicker1Copy.formattedDate}}",\n    "assigned_to": "{{Input2Copy.text}}",\n    "complete": false\n}\n')),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Note: The ","{","{ Table1.selectedRow.","_","ref ","}","} snippet evaluates to the selected row\u2019s ","_","ref which will be the row we want to edit.")),(0,o.kt)("p",null,"Here, we have an edited query that collects all the data from the form widgets on Modal2. Note that we use the mustache syntax to bind the data from the widgets onto the query body. We\u2019ll now need to configure the submit button; Go back to Modal2, set the button\u2019s onClick property to execute a query, and choose ",(0,o.kt)("em",{parentName:"p"},(0,o.kt)("strong",{parentName:"em"},"editTask"))," under the events property."),(0,o.kt)("figure",null,(0,o.kt)("object",{data:"https://www.youtube.com/embed/yW8m8kydNhQ?autoplay=0",width:"750px",height:"400px"}),(0,o.kt)("figcaption",{align:"center"},(0,o.kt)("i",null,"Updating Document"))),(0,o.kt)("h2",{id:"deleting-document"},"Deleting Document"),(0,o.kt)("p",null,"The ",(0,o.kt)("strong",{parentName:"p"},"Delete Document")," method deletes the document at the given path."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"First, select ",(0,o.kt)("inlineCode",{parentName:"li"},"Delete Document")," from the commands drop-down."),(0,o.kt)("li",{parentName:"ul"},"Next, add your document path.")),(0,o.kt)("p",null,"For example, \u201ctasks/issue","_","id\u201d and click run to delete that document."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Deleting a document by giving a non-existing path is ",(0,o.kt)("strong",{parentName:"p"},"NOT")," treated as an error.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create a new custom column on the table by clicking on Add a New Column under the columns property."),(0,o.kt)("li",{parentName:"ul"},"Now, rename this column to \u2018Delete Task,\u2019 and click on the cog icon next to it, to configure column settings. Under this, we\u2019ll see column-type properties set to a button type.")),(0,o.kt)("p",null,"Now, write the Delete query:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Click on the ",(0,o.kt)("inlineCode",{parentName:"li"},"+")," icon next to the data sources and choose the Create New + from the Firestore datasource."),(0,o.kt)("li",{parentName:"ul"},"Set the commands to Delete Document."),(0,o.kt)("li",{parentName:"ul"},"Set the ",(0,o.kt)("inlineCode",{parentName:"li"},"Collection/Document Path*")," to:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"tasks/{{Table1.selectedRow._ref}}\n")),(0,o.kt)("p",null,"Set the Delete Task button\u2019s onClick property to run the ",(0,o.kt)("inlineCode",{parentName:"p"},"deleteTask")," query."),(0,o.kt)("h2",{id:"server-side-pagination"},"Server-side Pagination"),(0,o.kt)("p",null,"Firestore supports server-side pagination with the Table widget. There are four fields in the query configuration that influence how this pagination works."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Order By"),": This is required to make pagination order predictable. It should be a JSON list of fields to use for ordering. ",(0,o.kt)("em",{parentName:"li"},"E.g."),", ",(0,o.kt)("inlineCode",{parentName:"li"},'["field1"]'),"."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Limit Documents"),": This will be the number of documents in each page, ",(0,o.kt)("em",{parentName:"li"},"i.e."),", the page size. A good value for this might be 10 or 15."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Start After"),": This should be set to the ",(0,o.kt)("em",{parentName:"li"},"document")," that marks the ",(0,o.kt)("em",{parentName:"li"},"end")," of the current page. Usually set to ",(0,o.kt)("inlineCode",{parentName:"li"},"{{queryName.data[queryName.data.length - 1]}}"),". The order by field should be unique for this to work in pagination."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"End Before"),": This should be set to the ",(0,o.kt)("em",{parentName:"li"},"document")," that marks the ",(0,o.kt)("em",{parentName:"li"},"start")," of the current page. Usually set to ",(0,o.kt)("inlineCode",{parentName:"li"},"{{queryName.data[0]}}"),".")),(0,o.kt)("p",null,"Once you have your Firestore query configured with these details, ensure the following three steps on your Table widget and the pagination should be ready:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The ",(0,o.kt)("em",{parentName:"li"},"Table Data")," should be set to ",(0,o.kt)("inlineCode",{parentName:"li"},"{{queryName.data}}")," (or something loosely similar)."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("em",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"em"},"Server side pagination"))," should be turned on, in the Table widget."),(0,o.kt)("li",{parentName:"ol"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"onPageChange")," should be set to run this Firestore query.")),(0,o.kt)("p",null,"Now try clicking the next and previous page buttons on this Table widget and the data should refresh."),(0,o.kt)("h2",{id:"using-queries-in-applications"},"Using Queries in applications"),(0,o.kt)("p",null,"Once you have successfully run a Query, you can use it in your application to"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/core-concepts/data-access-and-binding/displaying-data-read/"},"Display Data")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/core-concepts/data-access-and-binding/capturing-data-write/"},"Capture Data"))))}c.isMDXComponent=!0},5112:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Connecting_to_firestore-d6af61bb8be3b5b01375d7f6e3c1a8f1.png"},69311:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/Firestore_Fetching_account_credentials-9ac90564dc2e0470ee4d39dcc23fcfb9.png"},59172:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/firestore_modal_example-c2125d5fb13d8b0cbd5efdd2a518d844.png"},38540:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/firestore_set_document-873132be123ec814c315f6056f7c1729.png"},28647:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/firestore_update_document-eeb898b85d75ada2ae93916702b8566a.png"}}]);